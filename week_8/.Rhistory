library(tidyverse)
library(ggplot2)
library(skimr)
library(leaflet)
library(rgdal)
simd <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_and_simd.csv")
hospital_codes <- read_csv("../lookup_tables/current-hospital_codes.csv")
simd_postcodes <- read_csv("..//lookup_tables/SIMD+2020v2+-+postcode+lookup%232.csv")
health_b_geogr <- readxl::read_xlsx("../lookup_tables/health_board_lat_lon.csv.xlsx")
health_b <- readOGR(dsn = "../data/map_files/SG_NHS_HealthBoards_2019.shp",  layer = "SG_NHS_HealthBoards_2019")
# limit columns to postcode and quintile only
simd_postcodes <- simd_postcodes %>% select(Postcode, SIMD2020v2_Quintile) %>% mutate(SIMD = SIMD2020v2_Quintile)
hospital_codes <- hospital_codes %>% select(Location, Postcode)
skim(simd)
simd %>% distinct(HB)
# check SIMD per health board
simd %>% group_by(HB, SIMD) %>% summarise(SIMD_per_HB = n()) %>%
ggplot(aes(x = HB, y = SIMD_per_HB, fill = SIMD))+
geom_col(position = "dodge")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# check SIMD per health board
simd %>% group_by(HB, SIMD) %>% summarise(SIMD_per_HB = n()) %>%
ggplot(aes(x = HB, y = SIMD_per_HB, fill = SIMD))+
geom_col()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
simd %>%
group_by(Quarter, SIMD) %>%
summarise(number_admissions = n()) %>%
filter(!is.na(SIMD)) %>%
mutate(SIMD = as.factor(SIMD)) %>%
ggplot()+
geom_line(aes(x = Quarter, y = number_admissions, group = SIMD, colour = SIMD), size = 1)+
theme(axis.text.x = element_text(angle = 45, hjust = 1),
)+
# scale_x_date(date_breaks = "3 months", date_labels = "%b - %y")+
scale_colour_manual(values = c("#A5d8DD", "#4cb5f5","#1C4E80", "#488A99", "#1F3F49" ))+
labs(
title = "Number of Hospital Admissions by SIMD"
)
simd %>% filter(HB == "S08000016") %>% #filtered by specific Health Board
group_by(Quarter, SIMD) %>%
summarise(number_admissions = n()) %>%
filter(!is.na(SIMD)) %>%
mutate(SIMD = as.factor(SIMD)) %>%
ggplot()+
geom_col(aes(x = Quarter, y = number_admissions, fill = SIMD), size = 1)+
theme(axis.text.x = element_text(angle = 45, hjust = 1),
)+
# scale_x_date(date_breaks = "3 months", date_labels = "%b - %y")+
# scale_colour_manual(values = c("#A5d8DD", "#4cb5f5","#1C4E80", "#488A99", "#1F3F49" ))+
labs(
title = "Number of Hospital Admissions by SIMD"
)
# geometires
library(sf)
health_boards <- st_read(dsn = "../data/map_files/",
layer = "SG_NHS_HealthBoards_2019")
head(health_boards)
hb_geometry <- st_geometry(health_boards)
plot(hb_geometry)
leaflet(health_b_geogr) %>%
addTiles() %>%
addMarkers(
lng = ~ Longitude ,
lat = ~ Latitude,
clusterOptions = markerClusterOptions(),
icon = icons(iconUrl = "https://upload.wikimedia.org/wikipedia/en/thumb/0/0e/NHS_Scotland_logo.svg/251px-NHS_Scotland_logo.svg.png?20211005185941",iconWidth = 30, iconHeight = 30), label = ~ HBName)
View(age_and_sex)
library(tidyverse)
library(skimr)
library(lubridate)
library(tidyverse)
library(skimr)
library(lubridate)
age_and_sex <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv")
skim(age_and_sex)
head(age_and_sex)
tail(age_and_sex)
age_and_sex %>% distinct(AdmissionType)
age_and_sex %>% distinct(HB)
age_and_sex %>% group_by(AdmissionType)
age_and_sex %>% filter(AdmissionType == "Not Specified") %>% group_by(HB) %>% summarise()
age_and_sex %>% filter(Quarter == "2021Q3") %>%  group_by(AdmissionType, Sex, Age)
# number of admissions depending on the admission type and age group - this time for 2021 only
age_and_sex %>% filter(Quarter == "Q1" | Quarter == "Q4") %>% filter(Year == 2021) %>%
ggplot(aes(x = Age, fill = AdmissionType))+
geom_bar(position = "dodge",colour = "white")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
age_and_sex <- age_and_sex %>%
mutate(Year = substr(Quarter, 1, 4),
Quarter_single = substr(Quarter, 5, 6))
age_and_sex
age_and_sex %>% group_by(Year, Quarter_single, Sex, Age) %>% summarise(count = n()) %>% filter(Quarter_single == "Q1" | Quarter_single == "Q4") %>%
ggplot(aes(x = Age, y = Quarter_single , alpha = Year, fill = count)) +
geom_count()
age_and_sex %>% group_by(Date, Sex) %>% summarise(number_admissions = n()) %>%
ggplot()+
geom_line(aes(x = Date, y = number_admissions, group = Sex, colour = Sex))+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_x_date(date_breaks = "3 months", date_labels = "%b - %y")+
labs(
title = "Hospital Admissions by Gender"
)
age_and_sex <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv")
age_and_sex<- age_and_sex %>%
filter(!is.na(HBQF) & AdmissionType == "Elective Inpatients" | AdmissionType == " Elective Emergency Inpatients")
View(age_and_sex)
skim(age_and_sex)
age_and_sex %>% distinct(QuarterQF)
age_and_sex %>% group_by(QuarterQF) %>% summarise(n())
View(age_and_sex)
age_and_sex %>% group_by(AddmissionTypeQF) %>% summarise(n())
age_and_sex %>% group_by(AdmissionTypeQF) %>% summarise(n())
age_and_sex %>%
ggplot(aes(x = Quarter, y =AverageLengthOfStay, group = Age)) +
geom_point()
age_and_sex %>%
ggplot(aes(x = Quarter, y = Age, group = AverageLengthOfStay)) +
geom_point()
age_and_sex %>%
ggplot(aes(x = Age, y = AverageLengthOfStay)) +
geom_point()
age_and_sex %>% filter(Age == "0-9 years") %>%
ggplot(aes(x = Quarter, y = AverageLengthOfStay)) +
geom_point()
age_and_sex %>% filter(Age == "0-9 years") %>%
ggplot(aes(x = Quarter, y = AverageLengthOfStay)) +
theme((axis.text.x = element_text(angle = 45, hjust = 1)))+
geom_point()
age_and_sex %>% filter(Age == "0-9 years") %>%
ggplot(aes(x = Quarter, y = AverageLengthOfStay)) +
geom_point()+
theme((axis.text.x = element_text(angle = 45, hjust = 1)))
age_and_sex %>% filter(Age == "0-9 years") %>%
ggplot(aes(x = Quarter, y = AverageLengthOfStay)) +
geom_point()
age_and_sex %>% filter(Age == "0-9 years") %>%
ggplot(aes(x = Quarter, y = AverageLengthOfStay)) +
geom_point()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
age_and_sex %>% filter(Age == "0-9 years") %>%
ggplot(aes(x = Quarter, y = AverageLengthOfStay, group = Sex)) +
geom_point()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
age_and_sex %>% filter(Age == "0-9 years") %>%
ggplot(aes(x = Quarter, y = AverageLengthOfStay, fill = Sex)) +
geom_point()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
age_and_sex %>% filter(Age == "0-9 years") %>%
ggplot(aes(x = Quarter, y = AverageLengthOfStay, group = Sex, fill = Sex)) +
geom_point()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
age_and_sex %>% filter(Age == "0-9 years" & Sex == "Male") %>%
ggplot(aes(x = Quarter, y = AverageLengthOfStay, group = Sex, fill = Sex)) +
geom_point()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
age_and_sex %>% filter(Age == "0-9 years" & Sex == "Male") %>%
ggplot(aes(x = Quarter, y = AverageLengthOfStay, group = Sex, fill = Sex)) +
geom_point()+
geom_line()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
age_and_sex %>% filter(Age == "0-9 years") %>%
ggplot(aes(x = Quarter, y = AverageLengthOfStay, group = Sex, fill = Sex)) +
geom_point()+
geom_line()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
age_and_sex %>% filter(Age == "0-9 years") %>%
ggplot(aes(x = Quarter, y = AverageLengthOfStay, group = Sex, colour = Sex)) +
geom_point()+
geom_line()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
age_and_sex <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv")
age_and_sex <- age_and_sex %>%
filter(!is.na(HBQF) & AdmissionType == "Elective Inpatients" | AdmissionType == " Elective Emergency Inpatients"| AdmissionType == "Transfer")
age_and_sex %>% group_by(AdmissionTypeQF) %>% summarise(n())
age_and_sex %>% filter(Age == "0-9 years") %>%
ggplot(aes(x = Quarter, y = AverageLengthOfStay, group = Sex, colour = Sex)) +
geom_point()+
geom_line()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
View(age_and_sex)
library(tidyverse)
library(ggplot2)
library(skimr)
library(leaflet)
library(rgdal)
simd <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_and_simd.csv")
hospital_codes <- read_csv("../lookup_tables/current-hospital_codes.csv")
simd_postcodes <- read_csv("..//lookup_tables/SIMD+2020v2+-+postcode+lookup%232.csv")
health_b_geogr <- readxl::read_xlsx("../lookup_tables/health_board_lat_lon.csv.xlsx")
health_b <- readOGR(dsn = "../data/map_files/SG_NHS_HealthBoards_2019.shp",  layer = "SG_NHS_HealthBoards_2019")
# limit columns to postcode and quintile only
simd_postcodes <- simd_postcodes %>% select(Postcode, SIMD2020v2_Quintile) %>% mutate(SIMD = SIMD2020v2_Quintile)
hospital_codes <- hospital_codes %>% select(Location, Postcode)
library(tidyverse)
library(ggplot2)
library(skimr)
library(leaflet)
library(rgdal)
simd <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_and_simd.csv")
simd <- simd %>% filter(!is.na(HBQF))
# hospital_codes <- read_csv("../lookup_tables/current-hospital_codes.csv")
# simd_postcodes <- read_csv("..//lookup_tables/SIMD+2020v2+-+postcode+lookup%232.csv")
# health_b_geogr <- readxl::read_xlsx("../lookup_tables/health_board_lat_lon.csv.xlsx")
# health_b <- readOGR(dsn = "../data/map_files/SG_NHS_HealthBoards_2019.shp",  layer = "SG_NHS_HealthBoards_2019")
# # limit columns to postcode and quintile only
#
# simd_postcodes <- simd_postcodes %>% select(Postcode, SIMD2020v2_Quintile) %>% mutate(SIMD = SIMD2020v2_Quintile)
#
# hospital_codes <- hospital_codes %>% select(Location, Postcode)
View(simd)
hb_codes <- read_csv("../lookup_tables/health-board_codes-_main.csv")
View(hospital_codes)
View(health_b_geogr)
View(hb_codes)
library(tidyverse)
library(ggplot2)
library(skimr)
library(leaflet)
library(rgdal)
simd <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_and_simd.csv")
hb_codes <- read_csv("../lookup_tables/health-board_codes-_main.csv")
hb_codes <- hb_codes %>% select(HB, HBName)
simd <- simd %>% filter(!is.na(HBQF))
# hospital_codes <- read_csv("../lookup_tables/current-hospital_codes.csv")
# simd_postcodes <- read_csv("..//lookup_tables/SIMD+2020v2+-+postcode+lookup%232.csv")
# health_b_geogr <- readxl::read_xlsx("../lookup_tables/health_board_lat_lon.csv.xlsx")
# health_b <- readOGR(dsn = "../data/map_files/SG_NHS_HealthBoards_2019.shp",  layer = "SG_NHS_HealthBoards_2019")
# # limit columns to postcode and quintile only
#
# simd_postcodes <- simd_postcodes %>% select(Postcode, SIMD2020v2_Quintile) %>% mutate(SIMD = SIMD2020v2_Quintile)
#
# hospital_codes <- hospital_codes %>% select(Location, Postcode)
library(tidyverse)
library(ggplot2)
library(skimr)
library(leaflet)
library(rgdal)
simd <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_and_simd.csv")
hb_codes <- read_csv("../lookup_tables/health-board_codes-_main.csv")
hb_codes <- hb_codes %>% select(HB, HBName)
left_join(simd, hb_codes, by = "HB")
simd <- simd %>% filter(!is.na(HBQF))
# hospital_codes <- read_csv("../lookup_tables/current-hospital_codes.csv")
# simd_postcodes <- read_csv("..//lookup_tables/SIMD+2020v2+-+postcode+lookup%232.csv")
# health_b_geogr <- readxl::read_xlsx("../lookup_tables/health_board_lat_lon.csv.xlsx")
# health_b <- readOGR(dsn = "../data/map_files/SG_NHS_HealthBoards_2019.shp",  layer = "SG_NHS_HealthBoards_2019")
# # limit columns to postcode and quintile only
#
# simd_postcodes <- simd_postcodes %>% select(Postcode, SIMD2020v2_Quintile) %>% mutate(SIMD = SIMD2020v2_Quintile)
#
# hospital_codes <- hospital_codes %>% select(Location, Postcode)
library(tidyverse)
library(ggplot2)
library(skimr)
library(leaflet)
library(rgdal)
simd <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_and_simd.csv")
hb_codes <- read_csv("../lookup_tables/health-board_codes-_main.csv")
hb_codes <- hb_codes %>% select(HB, HBName)
simd <- left_join(simd, hb_codes, by = "HB")
simd <- simd %>% filter(!is.na(HBQF))
# hospital_codes <- read_csv("../lookup_tables/current-hospital_codes.csv")
# simd_postcodes <- read_csv("..//lookup_tables/SIMD+2020v2+-+postcode+lookup%232.csv")
# health_b_geogr <- readxl::read_xlsx("../lookup_tables/health_board_lat_lon.csv.xlsx")
# health_b <- readOGR(dsn = "../data/map_files/SG_NHS_HealthBoards_2019.shp",  layer = "SG_NHS_HealthBoards_2019")
# # limit columns to postcode and quintile only
#
# simd_postcodes <- simd_postcodes %>% select(Postcode, SIMD2020v2_Quintile) %>% mutate(SIMD = SIMD2020v2_Quintile)
#
# hospital_codes <- hospital_codes %>% select(Location, Postcode)
View(simd)
simd <- left_join(simd, hb_codes, by = "HB")
skim(simd)
simd <- simd %>% select(Quarter, HB, AdmissionType, SIMD, Episodes, LengthOfEpisode,AverageLengthOfEpisode, Stays, LengthOfStay, AverageLengthOfStay )
age_and_sex <- read_csv(here("inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv"))
library(tidyverse)
library(skimr)
library(lubridate)
library(here)
age_and_sex <- read_csv(here("inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv"))
age_and_sex <- read_csv(here("/inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv"))
library(tidyverse)
library(skimr)
library(lubridate)
library(here)
age_and_sex <- read_csv(here("/inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv"))
age_and_sex <- read_csv(here("inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv"))
age_and_sex <- read_csv(here("../raw_data/inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv"))
age_and_sex <- read_csv(here("inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv"))
covid_admissions_clean <- covid_admissions %>%
left_join(health_boards, by = "hb") %>%
mutate(week_ending = ymd(week_ending),
hb_name = coalesce(hb_name, "All"),
admission_type = coalesce(admission_type, "All"),
month = month(week_ending, label = TRUE),
year = year(week_ending))
age_and_sex <- read_csv(here("../raw_data/inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv"))
age_and_sex <- read_csv("../raw_data/inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv")
age_and_sex <- age_and_sex %>%
filter(!is.na(HBQF) & AdmissionType == "Elective Inpatients" | AdmissionType == " Elective Emergency Inpatients"| AdmissionType == "Transfer")
age_and_sex <- read_csv("../raw_data/inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv")
hb_codes <- read_csv("../raw_data/health_board.csv")
age_and_sex <- age_and_sex %>%
filter(!is.na(HBQF) & AdmissionType == "Elective Inpatients" | AdmissionType == " Elective Emergency Inpatients"| AdmissionType == "Transfer")
age_and_sex <- read_csv("../raw_data/inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv")
hb_codes <- read_csv("../raw_data/health_board.csv") %>% select(HB, HBName)
age_and_sex <- age_and_sex %>%
filter(!is.na(HBQF) & AdmissionType == "Elective Inpatients" | AdmissionType == " Elective Emergency Inpatients"| AdmissionType == "Transfer")
View(health_b)
View(health_b)
age_and_sex <- read_csv("../raw_data/inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv")
hb_codes <- read_csv("../raw_data/health_board.csv")
age_and_sex <- age_and_sex %>%
filter(!is.na(HBQF) & AdmissionType == "Elective Inpatients" | AdmissionType == " Elective Emergency Inpatients"| AdmissionType == "Transfer")
View(hb_codes)
age_and_sex <- read_csv("../raw_data/inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv")
hb_codes <- read_csv("../raw_data/health_board.csv") %>% select(HB, HBName)
age_and_sex <- age_and_sex %>%
filter(!is.na(HBQF) & AdmissionType == "Elective Inpatients" | AdmissionType == " Elective Emergency Inpatients"| AdmissionType == "Transfer")
age_and_sex <- read_csv("../raw_data/inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv")
hb_codes <- read_csv("../raw_data/health_board.csv") %>% select(HB, HBName)
age_and_sex <- age_and_sex %>%
filter(!is.na(HBQF) & AdmissionType == "Elective Inpatients" | AdmissionType == " Elective Emergency Inpatients"| AdmissionType == "Transfer") %>%
left_join(hb_codes, by = "HB")
age_and_sex
View(hb_codes)
library(tidyverse)
library(ggplot2)
library(skimr)
library(leaflet)
library(rgdal)
simd <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_and_simd.csv")
hb_codes <- read_csv("../lookup_tables/health-board_codes-_main.csv")
library(tidyverse)
library(ggplot2)
library(skimr)
library(leaflet)
library(rgdal)
simd <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_and_simd.csv")
hb_codes <- read_csv("../lookup_tables/health-board_codes-_main.csv")
library(tidyverse)
library(ggplot2)
library(skimr)
library(leaflet)
library(rgdal)
simd <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_and_simd.csv")
hb_codes <- read_csv("../lookup_tables/health-board_codes-_main.csv")
library(tidyverse)
library(ggplot2)
library(skimr)
library(leaflet)
library(rgdal)
simd <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_and_simd.csv")
hb_codes <- read_csv("../lookup_tables/current-hospital_codes.csv") %>% select(HB, HBName)
hb_codes <- read_csv("../lookup_tables/current-hospital_codes.csv")
View(hb_codes)
age_and_sex %>% group_by(Year, Quarter_single) %>% summarise(count = n()) %>%
ggplot(aes(x = Quarter_single, y = count, group = Year, colour = Year))+
geom_point()+
geom_line()
library(tidyverse)
library(skimr)
library(lubridate)
age_and_sex <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_age_and_sex.csv")
age_and_sex <- age_and_sex %>%
filter(!is.na(HBQF) & AdmissionType == "Elective Inpatients" | AdmissionType == " Elective Emergency Inpatients"| AdmissionType == "Transfer")
skim(age_and_sex)
age_and_sex %>% group_by(AdmissionTypeQF) %>% summarise(n())
age_and_sex %>% filter(Age == "0-9 years") %>%
ggplot(aes(x = Quarter, y = AverageLengthOfStay, group = Sex, colour = Sex)) +
geom_point()+
geom_line()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
age_and_sex %>%
ggplot(aes(x = ))
head(age_and_sex)
tail(age_and_sex)
age_and_sex %>% distinct(AdmissionType)
age_and_sex %>% distinct(HB)
age_and_sex %>% group_by(AdmissionType)
age_and_sex %>% filter(AdmissionType == "Not Specified") %>% group_by(HB) %>% summarise()
age_and_sex %>% filter(Quarter == "2021Q3") %>%  group_by(AdmissionType, Sex, Age)
# number of admissions depending on the admission type and age group - this time for 2021 only
age_and_sex %>% filter(Quarter == "Q1" | Quarter == "Q4") %>% filter(Year == 2021) %>%
ggplot(aes(x = Age, fill = AdmissionType))+
geom_bar(position = "dodge",colour = "white")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
age_and_sex %>% group_by(Year, Quarter_single) %>% summarise(count = n()) %>%
ggplot(aes(x = Quarter_single, y = count, group = Year, colour = Year))+
geom_point()+
geom_line()
age_and_sex %>% group_by(Year, Quarter_single, Sex, Age) %>% summarise(count = n()) %>% filter(Quarter_single == "Q1" | Quarter_single == "Q4") %>%
ggplot(aes(x = Quarter_single, y = count, fill = Age)) +
geom_col(position = "dodge", colour = "white")+
facet_wrap(~ Year)
age_and_sex %>% group_by(Year, Quarter_single, Sex, Age) %>% summarise(count = n()) %>% filter(Quarter_single == "Q1" | Quarter_single == "Q4") %>%
ggplot(aes(x = Age, y = Quarter_single , alpha = Year, fill = count)) +
geom_count()
library(shiny); runApp('C:/Users/justy/OneDrive/Desktop/DE21/codeclan_homework_JustynaRosiak/week_05/day_5/games_app.R')
library(tidyverse)
library(ggplot2)
library(skimr)
library(leaflet)
library(rgdal)
simd <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_and_simd.csv")
hb_codes <- read_csv("../../..")
library(tidyverse)
library(ggplot2)
library(skimr)
library(leaflet)
library(rgdal)
simd <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_and_simd.csv")
hb_codes <- read_csv("../../../public_health_scotland_project/public_health_scotland_project/raw_data/lookup_tables/health-board_codes-_main.csv")
simd <- simd %>% filter(is.na(HBQF) & !is.na(LocationQF))
hb_codes <- hb_codes %>% select(HB, HBName)
simd <- left_join(simd, hb_codes, by = "HB")
skim(simd)
simd <- simd %>% select(Quarter, HB, AdmissionType, SIMD, Episodes, LengthOfEpisode,AverageLengthOfEpisode, Stays, LengthOfStay, AverageLengthOfStay )
# hospital_codes <- read_csv("../lookup_tables/current-hospital_codes.csv")
# simd_postcodes <- read_csv("..//lookup_tables/SIMD+2020v2+-+postcode+lookup%232.csv")
# health_b_geogr <- readxl::read_xlsx("../lookup_tables/health_board_lat_lon.csv.xlsx")
# health_b <- readOGR(dsn = "../data/map_files/SG_NHS_HealthBoards_2019.shp",  layer = "SG_NHS_HealthBoards_2019")
# # limit columns to postcode and quintile only
#
# simd_postcodes <- simd_postcodes %>% select(Postcode, SIMD2020v2_Quintile) %>% mutate(SIMD = SIMD2020v2_Quintile)
#
# hospital_codes <- hospital_codes %>% select(Location, Postcode)
library(tidyverse)
library(ggplot2)
library(skimr)
library(leaflet)
library(rgdal)
simd <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_and_simd.csv")
hb_codes <- read_csv("../../../public_health_scotland_project/public_health_scotland_project/raw_data/lookup_tables/health-board_codes-_main.csv")
simd <- simd %>% filter(is.na(HBQF) & !is.na(LocationQF))
hb_codes <- hb_codes %>% select(HB, HBName)
simd <- left_join(simd, hb_codes, by = "HB")
skim(simd)
simd <- simd %>% select(Quarter, HB, AdmissionType, SIMD, Episodes, LengthOfEpisode,AverageLengthOfEpisode, Stays, LengthOfStay, AverageLengthOfStay )
# hospital_codes <- read_csv("../lookup_tables/current-hospital_codes.csv")
# simd_postcodes <- read_csv("..//lookup_tables/SIMD+2020v2+-+postcode+lookup%232.csv")
# health_b_geogr <- readxl::read_xlsx("../lookup_tables/health_board_lat_lon.csv.xlsx")
# health_b <- readOGR(dsn = "../data/map_files/SG_NHS_HealthBoards_2019.shp",  layer = "SG_NHS_HealthBoards_2019")
# # limit columns to postcode and quintile only
#
# simd_postcodes <- simd_postcodes %>% select(Postcode, SIMD2020v2_Quintile) %>% mutate(SIMD = SIMD2020v2_Quintile)
#
# hospital_codes <- hospital_codes %>% select(Location, Postcode)
library(tidyverse)
library(ggplot2)
library(skimr)
library(leaflet)
library(rgdal)
simd <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_and_simd.csv")
hb_codes <- read_csv("../../../public_health_scotland_project/public_health_scotland_project/raw_data/lookup_tables/health-board_codes-_main.csv")
simd <- simd %>% filter(is.na(HBQF) & !is.na(LocationQF))
hb_codes <- hb_codes %>% select(HB, HBName)
simd <- left_join(simd, hb_codes, by = "HB")
skim(simd)
simd <- simd %>% select(Quarter, HB, AdmissionType, SIMD, Episodes, LengthOfEpisode,AverageLengthOfEpisode, Stays, LengthOfStay, AverageLengthOfStay )
# hospital_codes <- read_csv("../lookup_tables/current-hospital_codes.csv")
# simd_postcodes <- read_csv("..//lookup_tables/SIMD+2020v2+-+postcode+lookup%232.csv")
# health_b_geogr <- readxl::read_xlsx("../lookup_tables/health_board_lat_lon.csv.xlsx")
# health_b <- readOGR(dsn = "../data/map_files/SG_NHS_HealthBoards_2019.shp",  layer = "SG_NHS_HealthBoards_2019")
# # limit columns to postcode and quintile only
#
# simd_postcodes <- simd_postcodes %>% select(Postcode, SIMD2020v2_Quintile) %>% mutate(SIMD = SIMD2020v2_Quintile)
#
# hospital_codes <- hospital_codes %>% select(Location, Postcode)
library(tidyverse)
library(ggplot2)
library(skimr)
library(leaflet)
library(rgdal)
simd <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_and_simd.csv")
hb_codes <- read_csv("../../../public_health_scotland_project/public_health_scotland_project/raw_data/lookup_tables/health-board_codes-_main.csv")
simd <- simd %>% filter(is.na(HBQF) & !is.na(LocationQF))
hb_codes <- hb_codes %>% select(HB, HBName)
simd <- left_join(simd, hb_codes, by = "HB")
skim(simd)
simd <- simd %>% select(Quarter, HB, AdmissionType, SIMD, Episodes, LengthOfEpisode,AverageLengthOfEpisode, Stays, LengthOfStay, AverageLengthOfStay )
# hospital_codes <- read_csv("../lookup_tables/current-hospital_codes.csv")
# simd_postcodes <- read_csv("..//lookup_tables/SIMD+2020v2+-+postcode+lookup%232.csv")
# health_b_geogr <- readxl::read_xlsx("../lookup_tables/health_board_lat_lon.csv.xlsx")
# health_b <- readOGR(dsn = "../data/map_files/SG_NHS_HealthBoards_2019.shp",  layer = "SG_NHS_HealthBoards_2019")
# # limit columns to postcode and quintile only
#
# simd_postcodes <- simd_postcodes %>% select(Postcode, SIMD2020v2_Quintile) %>% mutate(SIMD = SIMD2020v2_Quintile)
#
# hospital_codes <- hospital_codes %>% select(Location, Postcode)
library(tidyverse)
library(ggplot2)
library(skimr)
library(leaflet)
library(rgdal)
simd <- read_csv("..//data/inpatient_and_daycase_by_nhs_board_of_treatment_and_simd.csv")
hb_codes <- read_csv("../../../public_health_scotland_project/public_health_scotland_project/raw_data/lookup_tables/health-board_codes-_main.csv")
simd <- simd %>% filter(is.na(HBQF) & !is.na(LocationQF))
hb_codes <- hb_codes %>% select(HB, HBName)
simd <- left_join(simd, hb_codes, by = "HB")
skim(simd)
simd <- simd %>% select(Quarter, HB, AdmissionType, SIMD, Episodes, LengthOfEpisode,AverageLengthOfEpisode, Stays, LengthOfStay, AverageLengthOfStay )
# hospital_codes <- read_csv("../lookup_tables/current-hospital_codes.csv")
# simd_postcodes <- read_csv("..//lookup_tables/SIMD+2020v2+-+postcode+lookup%232.csv")
# health_b_geogr <- readxl::read_xlsx("../lookup_tables/health_board_lat_lon.csv.xlsx")
# health_b <- readOGR(dsn = "../data/map_files/SG_NHS_HealthBoards_2019.shp",  layer = "SG_NHS_HealthBoards_2019")
# # limit columns to postcode and quintile only
#
# simd_postcodes <- simd_postcodes %>% select(Postcode, SIMD2020v2_Quintile) %>% mutate(SIMD = SIMD2020v2_Quintile)
#
# hospital_codes <- hospital_codes %>% select(Location, Postcode)
